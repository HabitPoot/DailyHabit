let template = {
    "esv": [],
    "krv": [],
    "date": "2023-06-27T00:00:00",
    "book": "Genesis",
    "kbook": "창세기",
    "chapter": 1,
    "start": 1,
    "end": 5
}
let data = [
    {
        "esv": [
            "1| In the beginning, God created the heavens and the earth.",
            "2| The earth was without form and void, and darkness was over the face of the deep. And the Spirit of God was hovering over the face of the waters",
            "3| And God said, \"Let there be light,\" and there was light.",
            "4| And God saw that the light was good. And God separated the light from the darkness.",
            "5| God called the light Day, and the darkness he called Night. And there was evening and there was morning, the first day."
        ],
        "krv": [
            "1| 태초에 하나님이 천지를 창조하시니라",
            "2| 땅이 혼돈하고 공허하며 흑암이 깊음 위에 있고 하나님의 신은 수면에 운행 하시니라",
            "3| 하나님이 가라사대 빛이 있으라 하시매 빛이 있었고",
            "4| 그 빛이 하나님의 보시기에 좋았더라 하나님이 빛과 어두움을 나누사",
            "5| 빛을 낮이라 칭하시고 어두움을 밤이라 칭하시니라 저녁이 되며 아침이 되니 이는 첫째 날이니라"
        ],
        "date": "2023-06-27T00:00:00",
        "book": "Genesis",
        "kbook": "창세기",
        "chapter": 1,
        "start": 1,
        "end": 5
    },
    {
        "esv": [
            "6| And God said, \"Let there be an expanse in the midst of the waters, and let it separate the waters from the waters.\"",
            "7| And God made the expanse and separated the waters that were under the expanse from the waters that were above the expanse. And it was so.",
            "8| And God called the expanse Heaven. And there was evening and there was morning, the second day.",
            "9| And God said, \"Let the waters under the heavens be gathered together into one place, and let the dry land appear.\" And it was so.",
            "10| God called the dry land Earth, and the waters that were gathered together he called Seas. And God saw that it was good."
        ],
        "krv": [
            "6| 하나님이 가라사대 물 가운데 궁창이 있어 물과 물로 나뉘게 하리라 하시고",
            "7| 하나님이 궁창을 만드사 궁창 아래의 물과 궁창 위의 물로 나뉘게 하시매 그대로 되니라",
            "8| 하나님이 궁창을 하늘이라 칭하시니라 저녁이 되며 아침이 되니 이는 둘째 날이니라",
            "9| 하나님이 가라사대 천하의 물이 한곳으로 모이고 뭍이 드러나라 하시매 그대로 되니라",
            "10| 하나님이 뭍을 땅이라 칭하시고 모인 물을 바다라 칭하시니라 하나님의 보시기에 좋았더라"
        ],
        "date": "2023-06-28T00:00:00",
        "book": "Genesis",
        "kbook": "창세기",
        "chapter": 1,
        "start": 6,
        "end": 10
    },
    {
        "esv": [
            "11| And God said, \"Let the earth sprout vegetation, plants yielding seed, and fruit trees bearing fruit in which is their seed, each according to its kind, on the earth.\" And it was so.",
            "12| The earth brought forth vegetation, plants yielding seed according to their own kinds, and trees bearing fruit in which is their seed, each according to its kind. And God saw that it was good.",
            "13| And there was evening and there was morning, the third day.",
            "14| And God said, \"Let there be lights in the expanse of the heavens to separate the day from the night. And let them be for signs and for seasons, and for days and years,",
            "15| and let them be lights in the expanse of the heavens to give light upon the earth.\" And it was so."
        ],
        "krv": [
            "11| 하나님이 가라사대 땅은 풀과 씨 맺는 채소와 각기 종류대로 씨 가진 열매 맺는 과목을 내라 하시매 그대로 되어",
            "12| 땅이 풀과 각기 종류대로 씨 맺는 채소와 각기 종류대로 씨 가진 열매 맺는 나무를 내니 하나님의 보시기에 좋았더라",
            "13| 저녁이 되며 아침이 되니 이는 세째 날이니라",
            "14| 하나님이 가라사대 하늘의 궁창에 광명이 있어 주야를 나뉘게 하라 또 그 광명으로 하여 징조와 사시와 일자와 연한이 이루라",
            "15| 또 그 광명이 하늘의 궁창에 있어 땅에 비취라 하시고 (그대로 되니라)"
        ],
        "date": "2023-06-29T00:00:00",
        "book": "Genesis",
        "kbook": "창세기",
        "chapter": 1,
        "start": 11,
        "end": 15
    },
    {
        "esv": [
            "16| And God made the two great lights--the greater light to rule the day and the lesser light to rule the night--and the stars.",
            "17| And God set them in the expanse of the heavens to give light on the earth,",
            "18| to rule over the day and over the night, and to separate the light from the darkness. And God saw that it was good.",
            "19| And there was evening and there was morning, the fourth day.",
            "20| And God said, \"Let the waters swarm with swarms of living creatures, and let birds fly above the earth across the expanse of the heavens.\""
        ],
        "krv": [
            "16| 하나님이 두 큰 광명을 만드사 큰 광명으로 낮을 주관하게 하시고 작은 광명으로 밤을 주관하게 하시며 또 별들을 만드시고",
            "17| 하나님이 그것들을 하늘의 궁창에 두어 땅에 비취게 하시며",
            "18| 주야를 주관하게 하시며 빛과 어두움을 나뉘게 하시니라 하나님의 보시기에 좋았더라",
            "19| 저녁이 되며 아침이 되니 이는 네째 날이니라",
            "20| 하나님이 가라사대 물들은 생물로 번성케 하라 땅위 하늘의 궁창에는 새가 날으라 하시고"
        ],
        "date": "2023-06-30T00:00:00",
        "book": "Genesis",
        "kbook": "창세기",
        "chapter": 1,
        "start": 16,
        "end": 20
    },
    {
        "esv": [
            "21| So God created the great sea creatures and every living creature that moves, with which the waters swarm, according to their kinds, and every winged bird according to its kind. And God saw that it was good.",
            "22| And God blessed them, saying, \"Be fruitful and multiply and fill the waters in the seas, and let birds multiply on the earth.\"",
            "23| And there was evening and there was morning, the fifth day.",
            "24| And God said, \"Let the earth bring forth living creatures according to their kinds--livestock and creeping things and beasts of the earth according to their kinds.\" And it was so.",
            "25| And God made the beasts of the earth according to their kinds and the livestock according to their kinds, and everything that creeps on the ground according to its kind. And God saw that it was good."
        ],
        "krv": [
            "21| 하나님이 큰 물고기와 물에서 번성하여 움직이는 모든 생물을 그 종류대로, 날개 있는 모든 새를 그 종류대로 창조하시니 하니님의 보시기에 좋았더라",
            "22| 하나님이 그들에게 복을 주어 가라사대 생육하고 번성하여 여러 바다 물에 충만하라 새들도 땅에 번성하라 하시니라",
            "23| 저녁이 되며 아침이 되니 이는 다섯째 날이니라",
            "24| 하나님이 가라사대 땅은 생물을 그 종류대로 내되 육축과 기는것과 땅의 짐승을 종류대로 내라 하시고 (그대로 되니라)",
            "25| 하나님이 땅의 짐승을 그 종류대로, 육축을 그 종류대로, 땅에 기는 모든 것을 그 종류대로 만드시니 하나님의 보시기에 좋았더라"
        ],
        "date": "2023-07-01T00:00:00",
        "book": "Genesis",
        "kbook": "창세기",
        "chapter": 1,
        "start": 21,
        "end": 25
    },
    {
        "esv": [
            "26| Then God said, \"Let us make man in our image, after our likeness. And let them have dominion over the fish of the sea and over the birds of the heavens and over the livestock and over all the earth and over every creeping thing that creeps on the earth.\"",
            "27| So God created man in his own image, in the image of God he created him; male and female he created them.",
            "28| And God blessed them. And God said to them, \"Be fruitful and multiply and fill the earth and subdue it, and have dominion over the fish of the sea and over the birds of the heavens and over every living thing that moves on the earth.\"",
            "29| And God said, \"Behold, I have given you every plant yielding seed that is on the face of all the earth, and every tree with seed in its fruit. You shall have them for food.",
            "30| And to every beast of the earth and to every bird of the heavens and to everything that creeps on the earth, everything that has the breath of life, I have given every green plant for food.\" And it was so.",
            "31| And God saw everything that he had made, and behold, it was very good. And there was evening and there was morning, the sixth day."
        ],
        "krv": [
            "26| 하나님이 가라사대 우리의 형상을 따라 우리의 모양대로 우리가 사람을 만들고 그로 바다의 고기와 공중의 새와 육축과 온 땅과 땅에 기는 모든 것을 다스리게 하자 하시고",
            "27| 하나님이 자기 형상 곧 하나님의 형상대로 사람을 창조하시되 남자와 여자를 창조하시고",
            "28| 하나님이 그들에게 복을 주시며 그들에게 이르시되 생육하고 번성하여 땅에 충만하라, 땅을 정복하라, 바다의 고기와 공중의 새와 땅에 움직이는 모든 생물을 다스리라 하시니라",
            "29| 하나님이 가라사대 내가 온 지면의 씨 맺는 모든 채소와 씨 가진 열매 맺는 모든 나무를 너희에게 주노니 너희 식물이 되리라",
            "30| 또 땅의 모든 짐승과 공중의 모든 새와 생명이 있어 땅에 기는 모든 것에게는 내가 모든 푸른 풀을 식물로 주노라 하시니 그대로 되니라",
            "31| 하나님이 그 지으신 모든 것을 보시니 보시기에 심히 좋았더라 저녁이 되며 아침이 되니 이는 여섯째 날이니라"
        ],
        "date": "2023-07-02T00:00:00",
        "book": "Genesis",
        "kbook": "창세기",
        "chapter": 1,
        "start": 26,
        "end": 31
    },
    {
        "esv": [
            "1| Thus the heavens and the earth were finished, and all the host of them.",
            "2| And on the seventh day God finished his work that he had done, and he rested on the seventh day from all his work that he had done.",
            "3| So God blessed the seventh day and made it holy, because on it God rested from all his work that he had done in creation.",
            "4| These are the generations of the heavens and the earth when they were created, in the day that the Lord God made the earth and the heavens.",
            "5| When no bush of the field was yet in the land and no small plant of the field had yet sprung up--for the Lord God had not caused it to rain on the land, and there was no man to work the ground,",
            "6| and a mist was going up from the land and was watering the whole face of the ground--",
            "7| then the Lord God formed the man of dust from the ground and breathed into his nostrils the breath of life, and the man became a living creature.",
            "8| And the Lord God planted a garden in Eden, in the east, and there he put the man whom he had formed.",
            "9| And out of the ground the Lord God made to spring up every tree that is pleasant to the sight and good for food. The tree of life was in the midst of the garden, and the tree of the knowledge of good and evil.",
            "10| A river flowed out of Eden to water the garden, and there it divided and became four rivers.",
            "11| The name of the first is the Pishon. It is the one that flowed around the whole land of Havilah, where there is gold.",
            "12| And the gold of that land is good; bdellium and onyx stone are there.",
            "13| The name of the second river is the Gihon. It is the one that flowed around the whole land of Cush.",
            "14| And the name of the third river is the Tigris, which flows east of Assyria. And the fourth river is the Euphrates",
            "15| The Lord God took the man and put him in the garden of Eden to work it and keep it.",
            "16| And the Lord God commanded the man, saying, \"You may surely eat of every tree of the garden,",
            "17| but of the tree of the knowledge of good and evil you shall not eat, for in the day that you eat of it you shall surely die.\"",
            "18| Then the Lord God said, \"It is not good that the man should be alone; I will make him a helper fit for him.\"",
            "19| Now out of the ground the Lord God had formed every beast of the field and every bird of the heavens and brought them to the man to see what he would call them. And whatever the man called every living creature, that was its name.",
            "20| The man gave names to all livestock and to the birds of the heavens and to every beast of the field. But for Adam there was not found a helper fit for him.",
            "21| So the Lord God caused a deep sleep to fall upon the man, and while he slept took one of his ribs and closed up its place with flesh.",
            "22| And the rib that the Lord God had taken from the man he made into a woman and brought her to the man.",
            "23| Then the man said, \"This at last is bone of my bones and flesh of my flesh; she shall be called Woman, because she was taken out of Man.\"",
            "24| Therefore a man shall leave his father and his mother and hold fast to his wife, and they shall become one flesh.",
            "25| And the man and his wife were both naked and were not ashamed.",
        ],
        "krv": [
            "1| 천지와 만물이 다 이루니라",
            "2| 하나님의 지으시던 일이 일곱째 날이 이를 때에 마치니 그 지으시던 일이 다하므로 일곱째 날에 안식하시니라",
            "3| 하나님이 일곱째 날을 복 주사 거룩하게 하셨으니 이는 하나님이 그 창조하시며 만드시던 모든 일을 마치시고 이 날에 안식하셨음이더라",
            "4| 여호와 하나님이 천지를 창조하신 때에 천지의 창조된 대략이 이러하니라",
            "5| 여호와 하나님이 땅에 비를 내리지 아니하셨고 경작할 사람도 없었으므로 들에는 초목이 아직 없었고 밭에는 채소가 나지 아니하였으며",
            "6| 안개만 땅에서 올라와 온 지면을 적셨더라",
            "7| 여호와 하나님이 흙으로 사람을 지으시고 생기를 그 코에 불어 넣으시니 사람이 생령이 된지라",
            "8| 여호와 하나님이 동방의 에덴에 동산을 창설하시고 그 지으신 사람을 거기 두시고",
            "9| 여호와 하나님이 그 땅에서 보기에 아름답고 먹기에 좋은 나무가 나게 하시니 동산 가운데에는 생명나무와 선악을 알게하는 나무도 있더라",
            "10| 강이 에덴에서 발원하여 동산을 적시고 거기서부터 갈라져 네 근원이 되었으니",
            "11| 첫째의 이름은 비손이라 금이 있는 하월라 온 땅에 둘렸으며",
            "12| 그 땅의 금은 정금이요 그곳에는 베델리엄과 호마노도 있으며",
            "13| 둘째 강의 이름은 기혼이라 구스 온 땅에 둘렸고",
            "14| 세째 강의 이름은 힛데겔이라 앗수르 동편으로 흐르며 네째 강은 유브라데더라",
            "15| 여호와 하나님이 그 사람을 이끌어 에덴 동산에 두사 그것을 다스리며 지키게 하시고",
            "16| 여호와 하나님이 그 사람에게 명하여 가라사대 동산 각종 나무의 실과는 네가 임의로 먹되",
            "17| 선악을 알게하는 나무의 실과는 먹지 말라 네가 먹는 날에는 정녕 죽으리라 하시니라",
            "18| 여호와 하나님이 가라사대 사람의 독처하는 것이 좋지 못하니 내가 그를 위하여 돕는 배필을 지으리라 하시니라",
            "19| 여호와 하나님이 흙으로 각종 들짐승과 공중의 각종 새를 지으시고 아담이 어떻게 이름을 짓나 보시려고 그것들을 그에게로 이끌어 이르시니 아담이 각 생물을 일컫는 바가 곧 그 이름이라",
            "20| 아담이 모든 육축과 공중의 새와 들의 모든 짐승에게 이름을 주니라 아담이 돕는 배필이 없으므로",
            "21| 여호와 하나님이 아담을 깊이 잠들게 하시니 잠들매 그가 그 갈빗대 하나를 취하고 살로 대신 채우시고",
            "22| 여호와 하나님이 아담에게서 취하신 그 갈빗대로 여자를 만드시고 그를 아담에게로 이끌어 오시니",
            "23| 아담이 가로되 이는 내뼈 중의 뼈요 살 중의 살이라 이것을 남자에게서 취하였은즉 여자라 칭하리라 하니라",
            "24| 이러므로 남자가 부모를 떠나 그 아내와 연합하여 둘이 한 몸을 이룰찌로다",
            "25| 아담과 그 아내 두 사람이 벌거벗었으나 부끄러워 아니하니라",
        ],
        "date": "2023-07-03T00:00:00",
        "book": "Genesis",
        "kbook": "창세기",
        "chapter": 2,
        "start": 1,
        "end": 25
    }
]
let root = document.getElementById("root")
let body = document.getElementById("body")
let dark = document.getElementById("dark")
let light = document.getElementById("light")
let esv = document.getElementById("esv")
let krv = document.getElementById("krv")
let both = document.getElementById("both")
let textTags = document.getElementsByClassName("text-tags")
let tracker = document.getElementById("tracker")
let left = document.getElementById("left")
let right = document.getElementById("right")
let current = data[data.length - 1];

function retrieveSettings() {
    let lang = localStorage.getItem('language')
    lang ? setLanguage(lang) : setLanguage('krv')
    let prog = localStorage.getItem('progress')
    if (prog) {
        current = data[parseInt(prog)]
    } else {
        current = data[data.length - 1]
    }
    updateDay('none')
}

function updateDay(direction) {
    let pos = data.findIndex(d => d === current)
    switch (direction) {
        case 'left':
            if (pos > 0) pos--
            break
        case 'right':
            if (pos < data.length - 1) pos++
            break
    }
    current = data[pos]
    localStorage.setItem('progress', pos.toString())
    tracker.innerHTML = `Day ${pos + 1} of ${data.length} | ${new Date(current.date).toLocaleDateString()}`
    let lang = localStorage.getItem('language')
    setLanguage(lang)
}

function colorMode(color) {
    localStorage.setItem('mode', color)
    switch (color) {
        case 'dark':
            root.classList.add('bg-dark')
            root.classList.remove('bg-light')
            body.classList.add('bg-dark')
            body.classList.remove('bg-light')
            for (let tag of textTags) {
                tag.classList.add('dark')
                tag.classList.remove('light')
            }
            break
        default:
            root.classList.add('bg-light')
            root.classList.remove('bg-dark')
            body.classList.add('bg-light')
            body.classList.remove('bg-dark')
            for (let tag of textTags) {
                tag.classList.add('light')
                tag.classList.remove('dark')
            }
    }
}

function setLanguage(lang) {
    localStorage.setItem('language', lang)
    root.innerHTML = ""
    switch (lang) {
        case 'both':
            root.innerHTML += `<h3 class="text-tags">${current.kbook} ${current.chapter}:${current.start}-${current.end}</h3>`
            root.innerHTML += `<h3 class="text-tags">${current.book} ${current.chapter}:${current.start}-${current.end}</h3>`
            for (let i = 0; i < current.krv.length; i++) {
                root.innerHTML += `<p class="text-tags">${current.krv[i]}</p>`
                root.innerHTML += `<p class="text-tags">${current.esv[i]}</p>`
            }
            break
        default:
            root.innerHTML += `<h3 class="text-tags">${lang === 'krv' ? current.kbook : current.book} ${current.chapter}:${current.start}-${current.end}</h3>`
            for (let verse of current[lang]) {
                root.innerHTML += `<p class="text-tags">${verse}</p>`
            }
    }
    localStorage.getItem('mode') === 'dark' ? colorMode('dark') : colorMode('light')
}

light.addEventListener("click", function () {
    colorMode('light')
})
dark.addEventListener("click", function () {
    colorMode('dark')
})

esv.addEventListener("click", function () {
    setLanguage('esv')
})
krv.addEventListener("click", function () {
    setLanguage('krv')
})
both.addEventListener("click", function () {
    setLanguage('both')
})
left.addEventListener("click", function () {
    updateDay('left')
})
right.addEventListener("click", function () {
    updateDay('right')
})

retrieveSettings()