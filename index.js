let template = {
    "esv": [],
    "krv": [],
    "date": "2023-06-27T00:00:00",
    "book": "Genesis",
    "kbook": "창세기",
    "chapter": 1,
    "start": 1,
    "end": 5
}
let data = [
    {
        "esv": [
            "1| In the beginning, God created the heavens and the earth.",
            "2| The earth was without form and void, and darkness was over the face of the deep. And the Spirit of God was hovering over the face of the waters",
            "3| And God said, \"Let there be light,\" and there was light.",
            "4| And God saw that the light was good. And God separated the light from the darkness.",
            "5| God called the light Day, and the darkness he called Night. And there was evening and there was morning, the first day."
        ],
        "krv": [
            "1| 태초에 하나님이 천지를 창조하시니라",
            "2| 땅이 혼돈하고 공허하며 흑암이 깊음 위에 있고 하나님의 신은 수면에 운행 하시니라",
            "3| 하나님이 가라사대 빛이 있으라 하시매 빛이 있었고",
            "4| 그 빛이 하나님의 보시기에 좋았더라 하나님이 빛과 어두움을 나누사",
            "5| 빛을 낮이라 칭하시고 어두움을 밤이라 칭하시니라 저녁이 되며 아침이 되니 이는 첫째 날이니라"
        ],
        "date": "2023-06-27T00:00:00",
        "book": "Genesis",
        "kbook": "창세기",
        "chapter": 1,
        "start": 1,
        "end": 5
    },
    {
        "esv": [
            "6| And God said, \"Let there be an expanse in the midst of the waters, and let it separate the waters from the waters.\"",
            "7| And God made the expanse and separated the waters that were under the expanse from the waters that were above the expanse. And it was so.",
            "8| And God called the expanse Heaven. And there was evening and there was morning, the second day.",
            "9| And God said, \"Let the waters under the heavens be gathered together into one place, and let the dry land appear.\" And it was so.",
            "10| God called the dry land Earth, and the waters that were gathered together he called Seas. And God saw that it was good."
        ],
        "krv": [
            "6| 하나님이 가라사대 물 가운데 궁창이 있어 물과 물로 나뉘게 하리라 하시고",
            "7| 하나님이 궁창을 만드사 궁창 아래의 물과 궁창 위의 물로 나뉘게 하시매 그대로 되니라",
            "8| 하나님이 궁창을 하늘이라 칭하시니라 저녁이 되며 아침이 되니 이는 둘째 날이니라",
            "9| 하나님이 가라사대 천하의 물이 한곳으로 모이고 뭍이 드러나라 하시매 그대로 되니라",
            "10| 하나님이 뭍을 땅이라 칭하시고 모인 물을 바다라 칭하시니라 하나님의 보시기에 좋았더라"
        ],
        "date": "2023-06-28T00:00:00",
        "book": "Genesis",
        "kbook": "창세기",
        "chapter": 1,
        "start": 6,
        "end": 10
    },
    {
        "esv": [
            "11| And God said, \"Let the earth sprout vegetation, plants yielding seed, and fruit trees bearing fruit in which is their seed, each according to its kind, on the earth.\" And it was so.",
            "12| The earth brought forth vegetation, plants yielding seed according to their own kinds, and trees bearing fruit in which is their seed, each according to its kind. And God saw that it was good.",
            "13| And there was evening and there was morning, the third day.",
            "14| And God said, \"Let there be lights in the expanse of the heavens to separate the day from the night. And let them be for signs and for seasons, and for days and years,",
            "15| and let them be lights in the expanse of the heavens to give light upon the earth.\" And it was so."
        ],
        "krv": [
            "11| 하나님이 가라사대 땅은 풀과 씨 맺는 채소와 각기 종류대로 씨 가진 열매 맺는 과목을 내라 하시매 그대로 되어",
            "12| 땅이 풀과 각기 종류대로 씨 맺는 채소와 각기 종류대로 씨 가진 열매 맺는 나무를 내니 하나님의 보시기에 좋았더라",
            "13| 저녁이 되며 아침이 되니 이는 세째 날이니라",
            "14| 하나님이 가라사대 하늘의 궁창에 광명이 있어 주야를 나뉘게 하라 또 그 광명으로 하여 징조와 사시와 일자와 연한이 이루라",
            "15| 또 그 광명이 하늘의 궁창에 있어 땅에 비취라 하시고 (그대로 되니라)"
        ],
        "date": "2023-06-29T00:00:00",
        "book": "Genesis",
        "kbook": "창세기",
        "chapter": 1,
        "start": 11,
        "end": 15
    },
    {
        "esv": [
            "16| And God made the two great lights--the greater light to rule the day and the lesser light to rule the night--and the stars.",
            "17| And God set them in the expanse of the heavens to give light on the earth,",
            "18| to rule over the day and over the night, and to separate the light from the darkness. And God saw that it was good.",
            "19| And there was evening and there was morning, the fourth day.",
            "20| And God said, \"Let the waters swarm with swarms of living creatures, and let birds fly above the earth across the expanse of the heavens.\""
        ],
        "krv": [
            "16| 하나님이 두 큰 광명을 만드사 큰 광명으로 낮을 주관하게 하시고 작은 광명으로 밤을 주관하게 하시며 또 별들을 만드시고",
            "17| 하나님이 그것들을 하늘의 궁창에 두어 땅에 비취게 하시며",
            "18| 주야를 주관하게 하시며 빛과 어두움을 나뉘게 하시니라 하나님의 보시기에 좋았더라",
            "19| 저녁이 되며 아침이 되니 이는 네째 날이니라",
            "20| 하나님이 가라사대 물들은 생물로 번성케 하라 땅위 하늘의 궁창에는 새가 날으라 하시고"
        ],
        "date": "2023-06-30T00:00:00",
        "book": "Genesis",
        "kbook": "창세기",
        "chapter": 1,
        "start": 16,
        "end": 20
    },
    {
        "esv": [
            "21| So God created the great sea creatures and every living creature that moves, with which the waters swarm, according to their kinds, and every winged bird according to its kind. And God saw that it was good.",
            "22| And God blessed them, saying, \"Be fruitful and multiply and fill the waters in the seas, and let birds multiply on the earth.\"",
            "23| And there was evening and there was morning, the fifth day.",
            "24| And God said, \"Let the earth bring forth living creatures according to their kinds--livestock and creeping things and beasts of the earth according to their kinds.\" And it was so.",
            "25| And God made the beasts of the earth according to their kinds and the livestock according to their kinds, and everything that creeps on the ground according to its kind. And God saw that it was good."
        ],
        "krv": [
            "21| 하나님이 큰 물고기와 물에서 번성하여 움직이는 모든 생물을 그 종류대로, 날개 있는 모든 새를 그 종류대로 창조하시니 하니님의 보시기에 좋았더라",
            "22| 하나님이 그들에게 복을 주어 가라사대 생육하고 번성하여 여러 바다 물에 충만하라 새들도 땅에 번성하라 하시니라",
            "23| 저녁이 되며 아침이 되니 이는 다섯째 날이니라",
            "24| 하나님이 가라사대 땅은 생물을 그 종류대로 내되 육축과 기는것과 땅의 짐승을 종류대로 내라 하시고 (그대로 되니라)",
            "25| 하나님이 땅의 짐승을 그 종류대로, 육축을 그 종류대로, 땅에 기는 모든 것을 그 종류대로 만드시니 하나님의 보시기에 좋았더라"
        ],
        "date": "2023-07-01T00:00:00",
        "book": "Genesis",
        "kbook": "창세기",
        "chapter": 1,
        "start": 21,
        "end": 25
    }
]
let root = document.getElementById("root")
let body = document.getElementById("body")
let dark = document.getElementById("dark")
let light = document.getElementById("light")
let esv = document.getElementById("esv")
let krv = document.getElementById("krv")
let both = document.getElementById("both")
let textTags = document.getElementsByClassName("text-tags")
let tracker = document.getElementById("tracker")
let left = document.getElementById("left")
let right = document.getElementById("right")
let current = data[data.length - 1];

function retrieveSettings() {
    let lang = localStorage.getItem('language')
    lang ? setLanguage(lang) : setLanguage('krv')
    let prog = localStorage.getItem('progress')
    if (prog) {
        current = data[parseInt(prog)]
    } else {
        current = data[data.length - 1]
    }
    updateDay('none')
}

function updateDay(direction) {
    let pos = data.findIndex(d => d === current)
    switch (direction) {
        case 'left':
            if (pos > 0) pos--
            break
        case 'right':
            if (pos < data.length - 1) pos++
            break
    }
    current = data[pos]
    localStorage.setItem('progress', pos.toString())
    tracker.innerHTML = `Day ${pos + 1} of ${data.length} | ${new Date(current.date).toLocaleDateString()}`
    let lang = localStorage.getItem('language')
    setLanguage(lang)
}

function colorMode(color) {
    localStorage.setItem('mode', color)
    switch (color) {
        case 'dark':
            root.classList.add('bg-dark')
            root.classList.remove('bg-light')
            body.classList.add('bg-dark')
            body.classList.remove('bg-light')
            for (let tag of textTags) {
                tag.classList.add('dark')
                tag.classList.remove('light')
            }
            break
        default:
            root.classList.add('bg-light')
            root.classList.remove('bg-dark')
            body.classList.add('bg-light')
            body.classList.remove('bg-dark')
            for (let tag of textTags) {
                tag.classList.add('light')
                tag.classList.remove('dark')
            }
    }
}

function setLanguage(lang) {
    localStorage.setItem('language', lang)
    root.innerHTML = ""
    switch (lang) {
        case 'both':
            root.innerHTML += `<h3 class="text-tags">${current.kbook} ${current.chapter}:${current.start}-${current.end}</h3>`
            root.innerHTML += `<h3 class="text-tags">${current.book} ${current.chapter}:${current.start}-${current.end}</h3>`
            for (let i = 0; i < current.krv.length; i++) {
                root.innerHTML += `<p class="text-tags">${current.krv[i]}</p>`
                root.innerHTML += `<p class="text-tags">${current.esv[i]}</p>`
            }
            break
        default:
            root.innerHTML += `<h3 class="text-tags">${lang === 'krv' ? current.kbook : current.book} ${current.chapter}:${current.start}-${current.end}</h3>`
            for (let verse of current[lang]) {
                root.innerHTML += `<p class="text-tags">${verse}</p>`
            }
    }
    localStorage.getItem('mode') === 'dark' ? colorMode('dark') : colorMode('light')
}

light.addEventListener("click", function () {
    colorMode('light')
})
dark.addEventListener("click", function () {
    colorMode('dark')
})

esv.addEventListener("click", function () {
    setLanguage('esv')
})
krv.addEventListener("click", function () {
    setLanguage('krv')
})
both.addEventListener("click", function () {
    setLanguage('both')
})
left.addEventListener("click", function () {
    updateDay('left')
})
right.addEventListener("click", function () {
    updateDay('right')
})

retrieveSettings()